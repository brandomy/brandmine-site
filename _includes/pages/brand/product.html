{% comment %}
  Product Section
  Displays: Product range content and gallery
  Supports: Both YAML and JSON data sources
{% endcomment %}

{% assign brand = include.brand | default: page %}
{% assign data_source = include.data_source | default: "curated" %}

<h2 id="heading-product" class="panel__heading-secondary">
  {% include helpers/t.html key="brand.products" fallback="Products" lang=brand.lang %}
</h2>

<div class="brand-products">
  <!-- Product Content from Markdown -->
  <div class="brand-products__content">
    {% assign content_parts = content | split: "## Product Range" %}
    {% if content_parts.size > 1 %}
      {% assign product_content = content_parts[1] | split: "##" | first %}
      {{ product_content | markdownify }}
    {% endif %}
  </div>

  <!-- Product Gallery -->
  {% if brand.gallery and brand.gallery.size > 0 %}
    <div class="brand-products__gallery product-gallery">
      {% for item in brand.gallery %}
        <div class="product-gallery__item">
          {% include components/images/collection-image.html
            collection="brands"
            slug=brand.ref
            purpose="gallery"
            name=item.name
            ext=item.ext
            alt=item.caption %}
          {% if item.caption %}
            <div class="product-gallery__caption">{{ item.caption }}</div>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% endif %}
</div>
