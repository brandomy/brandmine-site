{% comment %}
  Location Intelligence Section
  Displays: Interactive map, geographic context, regional significance
  Supports: Both YAML and JSON data sources
{% endcomment %}

{% assign brand = include.brand %}
{% assign data_source = include.data_source | default: "curated" %}

{% if brand.location and brand.location.lat and brand.location.lng %}
<h2 id="heading-location-intelligence" class="panel__heading-secondary">
      {% include helpers/t.html key="brand.location_intelligence" fallback="Location Intelligence" lang=brand.lang %}
    </h2>
    
    <div class="location-intelligence">
      <div class="brand-map" 
           data-lat="{{ brand.location.lat }}" 
           data-lng="{{ brand.location.lng }}"
           data-brand-name="{{ brand.title | default: brand.name }}"
           data-brand-ref="{{ include.brand_ref }}">
        <div class="brand-map__container" id="brand-map-{{ include.brand_ref }}">
          <!-- Map will be initialized by JavaScript -->
        </div>
        <div class="brand-map__fallback">
          <p>{% include helpers/t.html key="brand.map_loading" fallback="Loading interactive map..." lang=brand.lang %}</p>
        </div>
      </div>
      
      <div class="location-context">
        <div class="location-context__primary">
          <h3 class="location-context__title">
            {{ brand.location.city }}{% if brand.location.region %}, {{ brand.location.region }}{% endif %}
          </h3>
          <p class="location-context__country">
            {% assign country_name = site.data.countries.countries[brand.location.country].name[brand.lang] %}
            {{ country_name | default: brand.location.country }}
          </p>
        </div>
        
        {% if brand.location.lat and brand.location.lng %}
        <div class="location-context__coordinates">
          <span class="coordinates-label">{% include helpers/t.html key="brand.coordinates" fallback="Coordinates" lang=brand.lang %}:</span>
          <span class="coordinates-value">{{ brand.location.lat }}, {{ brand.location.lng }}</span>
        </div>
        {% endif %}
        
        {% comment %} Link to market exploration {% endcomment %}
        {% if brand.location.country %}
        <div class="location-context__explore">
          <a href="{{ site.baseurl }}/{{ brand.lang }}/discover/markets/{{ brand.location.country }}/" class="btn btn--secondary">
            {% include helpers/t.html key="discover.explore_market" fallback="Explore Market" lang=brand.lang %}
          </a>
        </div>
        {% endif %}
      </div>
{% endif %}