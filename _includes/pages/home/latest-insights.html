{% comment %}
  Page Section: pages/home/latest-insights.html
  
  Purpose: Displays latest insights in a premium 2x2 grid layout with enhanced
           card design, perfect spacing, and mobile-first responsive behavior
  
  Section Type: Content
  Template: home.html
  
  Parameters:
    panel_type (optional): Panel style/color
                          Default: "primary-soft"
    title (optional): Custom section title
                     Default: "Latest Insights" from translations
  
  Dependencies:
    - Translation keys: insights.*
    - CSS: assets/css/pages/home/latest-insights.scss
    - Include: components/cards/insight-latest-card.html
  
  Usage:
    {% include pages/home/latest-insights.html %}
    {% include pages/home/latest-insights.html panel_type="light" %}
{% endcomment %}

{% assign current_lang = page.lang | default: 'en' %}
{% assign t = site.data.translations[current_lang].insights %}
{% assign panel_type = include.panel_type | default: "primary-soft" %}

<div class="latest-insights__header">
  <h2 class="panel__heading-secondary">
    {{ include.title | default: t.latest | default: "Latest Insights" }}
  </h2>
  <p class="latest-insights__subtitle">
    {% include helpers/t.html key="insights.latest_description" fallback="Stay updated with the latest perspectives from BRICS+ markets, founder stories, and growth opportunities" %}
  </p>
</div>

{% comment %} Build array of insights for atomic grid - preserve exact category filtering {% endcomment %}
{% assign filtered_insights = site.insights | where: "lang", current_lang %}
{% assign category_insights = '' | split: '' %}

{% comment %} Get one insight from each category in order - same logic as before {% endcomment %}
{% assign brand_spotlight = filtered_insights | where: "category", "brand-spotlight" | sort: "date" | reverse | first %}
{% assign founders_journey = filtered_insights | where: "category", "founders-journey" | sort: "date" | reverse | first %}
{% assign location_intelligence = filtered_insights | where: "category", "location-intelligence" | sort: "date" | reverse | first %}
{% assign market_momentum = filtered_insights | where: "category", "market-momentum" | sort: "date" | reverse | first %}

{% if brand_spotlight %}
  {% assign category_insights = category_insights | push: brand_spotlight %}
{% endif %}
{% if founders_journey %}
  {% assign category_insights = category_insights | push: founders_journey %}
{% endif %}
{% if location_intelligence %}
  {% assign category_insights = category_insights | push: location_intelligence %}
{% endif %}
{% if market_momentum %}
  {% assign category_insights = category_insights | push: market_momentum %}
{% endif %}

{% comment %} Use atomic grid with new container class {% endcomment %}
<div class="latest-insights__container--atomic">
  {% include components/layout/grid.html items=category_insights type="insight" limit=4 %}
</div>

<div class="latest-insights__footer">
  <a href="{{ site.baseurl }}/{{ current_lang }}/insights/" class="btn btn--primary-cta">
    {{ t.view_all | default: "View All Insights" }}
  </a>
</div>