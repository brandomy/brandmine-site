{% comment %}
Test version of latest insights using universal grid
Compare side-by-side with original before replacing
{% endcomment %}

{% assign current_lang = page.lang | default: 'en' %}

<!-- DEBUG: Test universal-card insight support -->
<div class="debug-section" style="border: 2px solid red; padding: 1rem; margin-bottom: 2rem;">
  <h3>DEBUG: Universal-Card Insight Test</h3>
  
  <!-- Test 1: Get any insight -->
  {% assign sample_insight = site.insights | where: "lang", current_lang | first %}
  
  {% if sample_insight %}
    <p><strong>Sample insight found:</strong> {{ sample_insight.title }}</p>
    <p><strong>Category:</strong> {{ sample_insight.category }}</p>
    <p><strong>Date:</strong> {{ sample_insight.date }}</p>
    
    <!-- Test 2: Try to render with universal-card -->
    <div style="max-width: 350px; border: 1px solid blue; padding: 1rem;">
      <h4>Universal-Card Rendering Test:</h4>
      {% include components/cards/universal-card.html
         item=sample_insight
         type="insight"
         variant="standard"
         config_set="universal-card" %}
    </div>
  {% else %}
    <p style="color: red;"><strong>ERROR:</strong> No insights found for language {{ current_lang }}</p>
  {% endif %}
  
  <!-- Test 3: Count total insights -->
  {% assign all_insights = site.insights | where: "lang", current_lang %}
  <p><strong>Total insights for {{ current_lang }}:</strong> {{ all_insights.size }}</p>
  
  <!-- Test 4: Show first few insight titles -->
  <p><strong>First 3 insight titles:</strong></p>
  <ul>
  {% for insight in all_insights limit: 3 %}
    <li>{{ insight.title }} ({{ insight.category }})</li>
  {% endfor %}
  </ul>
</div>

{% comment %}
Match original latest-insights data selection:
Get 1 insight from each of 4 specific categories
{% endcomment %}

{% assign filtered_insights = site.insights | where: "lang", current_lang %}

{% assign brand_spotlight = filtered_insights | where: "category", "brand-spotlight" | sort: "date" | reverse | first %}
{% assign founders_journey = filtered_insights | where: "category", "founders-journey" | sort: "date" | reverse | first %}
{% assign location_intelligence = filtered_insights | where: "category", "location-intelligence" | sort: "date" | reverse | first %}
{% assign market_momentum = filtered_insights | where: "category", "market-momentum" | sort: "date" | reverse | first %}

{% comment %}
Create array of category insights (matching original pattern)
{% endcomment %}
{% assign category_insights = "" | split: "" %}
{% if brand_spotlight %}
  {% assign category_insights = category_insights | push: brand_spotlight %}
{% endif %}
{% if founders_journey %}
  {% assign category_insights = category_insights | push: founders_journey %}
{% endif %}
{% if location_intelligence %}
  {% assign category_insights = category_insights | push: location_intelligence %}
{% endif %}
{% if market_momentum %}
  {% assign category_insights = category_insights | push: market_momentum %}
{% endif %}

<div class="latest-insights__header">
  <h2 class="panel__heading-secondary">
    {% include helpers/t.html key="home.latest_insights.title" fallback="Latest Insights TEST" %}
  </h2>
  <p class="latest-insights__subtitle">
    {% include helpers/t.html key="home.latest_insights.subtitle" fallback="Fresh perspectives from the BRICS+ market" %}
  </p>
</div>

<div class="latest-insights__content">
  {% include components/layout/grid.html
     items=category_insights
     card_type="insight"
     variant="compact"
     grid_type="auto"
     config_set="universal-grid"
     card_component="legacy-insight-card" %}
</div>

<div class="latest-insights__footer">
  <a href="{{ site.baseurl }}/{{ current_lang }}/insights/" class="btn btn--primary-cta">
    {% include helpers/t.html key="home.latest_insights.view_all" fallback="View All Insights" %}
  </a>
</div>