{% comment %}
================================================================================
COMPONENT: Main Navigation
PATH: _includes/components/navigation/navigation.html
PURPOSE: Multi-level main site navigation with dropdown support, active state detection, and full accessibility
CREATED: 2024-01-01 | VERSION: 2.0
================================================================================

Features:
- Multi-level dropdown navigation with unlimited nesting support
- Automatic active state detection based on current page URL
- Full multilingual support with translation integration
- Accessibility-compliant with ARIA attributes and keyboard navigation
- Mobile-responsive with collapsible menu functionality
- Semantic HTML5 navigation structure
- Parent-child active state inheritance
- Dynamic navigation structure from data files

Parameters:
- No direct parameters (uses global site and page variables)
- page.lang (implicit): String - Current page language for navigation structure
- page.url (implicit): String - Current page URL for active state detection
- site.data.navigation[lang] (implicit): Array - Navigation structure definition
- site.data.translations[lang].nav (implicit): Object - Navigation item translations

Dependencies:
- CSS: assets/css/layout/header.scss (navigation styling)
- JavaScript: assets/js/components/navigation/header-toggle.js (dropdown functionality)
- Data: site.data.navigation for structure definition per language
- Data: site.data.translations for navigation item text
- Components: Works with header toggle button for mobile menu

Usage Examples:
{% include components/navigation/navigation.html %}

Real-world Usage:
Used in site header as primary navigation across all pages and languages

Navigation Structure:
Defined in _data/navigation/[lang].yml with hierarchical structure:
- Top-level items with name, link, and optional children array
- Child items support unlimited nesting depth
- Translation keys reference site.data.translations[lang].nav

BEM Structure:
- .navigation (main navigation container)
- .navigation__list (navigation menu list)
- .navigation__item (individual navigation items)
- .navigation__link (navigation links)
- .navigation__item--active (active state modifier)
- .navigation__item--has-children (dropdown parent modifier)
- .navigation__dropdown (dropdown submenu container)
- .navigation__dropdown-list (dropdown menu list)
- .navigation__dropdown-item (dropdown menu items)
- .navigation__dropdown-link (dropdown links)

Accessibility:
- Semantic nav element with aria-label for navigation landmark
- Proper heading hierarchy for navigation structure
- aria-expanded for dropdown state indication
- aria-haspopup for dropdown menu identification
- Keyboard navigation support (Enter, Escape, Arrow keys)
- Screen reader friendly active state indicators
- Focus management for dropdown interactions

Responsive:
- Mobile: Collapsible menu with hamburger toggle
- Tablet: Horizontal navigation with touch-friendly dropdowns
- Desktop: Full horizontal navigation with hover-activated dropdowns

Performance Notes:
- Efficient active state detection with URL matching
- Minimal DOM manipulation for dropdown functionality
- CSS-only responsive behavior with JavaScript enhancement
- Cached translation lookups for navigation text
- Optimized navigation structure loading from data files

Active State Logic:
- Exact URL matching for direct page matches
- Parent activation when child pages are active
- Flexible matching for dynamic page structures
- Multi-level inheritance for nested navigation
================================================================================
{% endcomment %}
{% endcomment %}

{% comment %}Using t.html helper for navigation translations{% endcomment %}

<nav class="header__nav" id="main-nav">
  <ul class="header__nav-list">
    {% for item in site.data.navigation[page.lang] %}
      {% assign key = item.name | remove: 'nav.' %}
      {% assign item_active = false %}
      {% if page.url contains item.link %}
        {% assign item_active = true %}
      {% endif %}
      
      <li class="header__nav-item {% if item.children %}header__dropdown{% endif %} {% if item_active %}header__nav-item--active{% endif %}">
        <a href="{{ item.link | relative_url }}" 
           {% if item.children %}role="button" aria-haspopup="true" aria-expanded="false"{% endif %}
           {% if item_active %}class="active"{% endif %}>
          {% assign nav_key = "nav." | append: key %}
          {% include helpers/t.html key=nav_key fallback=key %}
          {% if item.children %}<span class="header__dropdown-icon" aria-hidden="true">&#x25BE;</span>{% endif %}
        </a>
        
        {% if item.children %}
          <ul class="header__dropdown-content" role="menu">
            {% for child in item.children %}
              {% assign child_key = child.name | remove: 'nav.' %}
              {% assign child_active = false %}
              {% if page.url contains child.link %}
                {% assign child_active = true %}
              {% endif %}
              
              <li class="header__dropdown-item {% if child_active %}header__dropdown-item--active{% endif %}">
                <a href="{{ child.link | relative_url }}" 
                   {% if child_active %}class="active"{% endif %}>
                  {% assign child_nav_key = "nav." | append: child_key %}
                  {% include helpers/t.html key=child_nav_key fallback=child_key %}
                </a>
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
</nav>