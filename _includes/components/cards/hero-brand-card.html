{% comment %}
  Include Name: components/cards/hero-brand-card.html

  Purpose: Displays an enhanced brand card with hero image for higher-level featured brands.

  Parameters:
  - brand: Brand object with complete details (required)
{% endcomment %}

{% assign t = site.data.translations[page.lang].brand %}
{% assign buttons_t = site.data.translations[page.lang].buttons %}

{% comment %}
  Extract image names from full paths
{% endcomment %}
{% if brand.hero_image %}
  {% assign hero_path_parts = brand.hero_image | split: "/" %}
  {% assign hero_filename = hero_path_parts.last | split: "." | first %}
  {% if hero_filename contains "hero-" %}
    {% assign hero_name = hero_filename | remove: "hero-" %}
  {% else %}
    {% assign hero_name = hero_filename %}
  {% endif %}
{% endif %}

{% if brand.logo %}
  {% assign logo_path_parts = brand.logo | split: "/" %}
  {% assign logo_filename = logo_path_parts.last | split: "." | first %}
  {% if logo_filename contains "logo-" %}
    {% assign logo_name = logo_filename | remove: "logo-" %}
  {% else %}
    {% assign logo_name = logo_filename %}
  {% endif %}
{% endif %}

{% if brand.founder_portrait %}
  {% assign founder_path_parts = brand.founder_portrait | split: "/" %}
  {% assign founder_filename = founder_path_parts.last | split: "." | first %}
  {% if founder_filename contains "founder-" %}
    {% assign founder_name = founder_filename | remove: "founder-" %}
  {% else %}
    {% assign founder_name = founder_filename %}
  {% endif %}
{% endif %}

<article class="hero-brand-card {% if brand.featured or brand.featured_level > 1 %}hero-brand-card--featured{% endif %}">
  <div class="hero-brand-card__image">
    {% include components/images/collection-image.html
       collection="brands"
       slug=brand.ref
       purpose="hero"
       name=hero_name
       alt=brand.title
       class="hero-brand-card__img" %}

    <div class="hero-brand-card__logo">
      {% if logo_name %}
        {% include components/images/collection-image.html
           collection="brands"
           slug=brand.ref
           purpose="logo"
           name=logo_name
           ext="png"
           alt=brand.title
           class="hero-brand-card__logo-img" %}
      {% else %}
        {% comment %} Fallback if we can't extract the logo name {% endcomment %}
        {% include components/images/collection-image.html
           collection="brands"
           slug=brand.ref
           purpose="logo"
           ext="png"
           alt=brand.title
           class="hero-brand-card__logo-img" %}
      {% endif %}
    </div>
  </div>

  <div class="hero-brand-card__body">
    <div class="hero-brand-card__content-wrapper">
      <div class="hero-brand-card__main-content">
        <h2 class="hero-brand-card__title">{{ brand.title }}</h2>

        <div class="hero-brand-card__meta">
          {% include components/helpers/founding-year.html
             brand=brand
             class_name="hero-brand-card" %}

          {% include components/helpers/location-display.html
             brand=brand
             class_name="hero-brand-card" %}
        </div>

        <p class="hero-brand-card__description">{{ brand.description }}</p>
      </div>

      <!-- Founder portrait -->
      {% if brand.founder_portrait %}
        <div class="hero-brand-card__founder">
          {% include components/images/collection-image.html
             collection="brands"
             slug=brand.ref
             purpose="founder"
             name=founder_name
             aspect="portrait"
             alt=brand.founders.first
             class="hero-brand-card__founder-img" %}
        </div>
      {% endif %}
    </div>

    <!-- Taxonomy section -->
    <div class="hero-brand-card__taxonomy">
      <div class="hero-brand-card__taxonomy-section">
        <div class="hero-brand-card__tags">
          <!-- Markets -->
          {% if brand.markets %}
            {% for market in brand.markets %}
              <a href="{{ site.baseurl }}/{{ page.lang }}/discover/markets/{{ market | slugify }}/"
                 class="brand-tag brand-tag--market">
                {% if site.data.dimensions.markets[market][page.lang] %}
                  {{ site.data.dimensions.markets[market][page.lang] }}
                {% else %}
                  {{ market }}
                {% endif %}
              </a>
            {% endfor %}
          {% endif %}

          <!-- Sectors -->
          {% if brand.sectors %}
            {% for sector in brand.sectors %}
              <a href="{{ site.baseurl }}/{{ page.lang }}/discover/sectors/{{ sector | slugify }}/"
                 class="brand-tag brand-tag--sector">
                {% if site.data.dimensions.sectors[sector][page.lang] %}
                  {{ site.data.dimensions.sectors[sector][page.lang] }}
                {% else %}
                  {{ sector }}
                {% endif %}
              </a>
            {% endfor %}
          {% endif %}

          <!-- Attributes -->
          {% if brand.attributes %}
            {% for attribute in brand.attributes %}
              <a href="{{ site.baseurl }}/{{ page.lang }}/discover/attributes/{{ attribute | slugify }}/"
                 class="brand-tag brand-tag--attribute">
                {% if site.data.dimensions.attributes[attribute][page.lang] %}
                  {{ site.data.dimensions.attributes[attribute][page.lang] }}
                {% else %}
                  {{ attribute }}
                {% endif %}
              </a>
            {% endfor %}
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <div class="hero-brand-card__footer">
    <!-- Signals -->
    {% if brand.signals and brand.signals.size > 0 %}
    <div class="hero-brand-card__signals">
      {% for signal in brand.signals %}
        <a href="{{ site.baseurl }}/{{ page.lang }}/discover/signals/{{ signal | slugify }}/"
           class="brand-tag brand-tag--signal">
          {% if site.data.dimensions.signals[signal][page.lang] %}
            {{ site.data.dimensions.signals[signal][page.lang] }}
          {% else %}
            {{ signal }}
          {% endif %}
        </a>
      {% endfor %}
    </div>
    {% endif %}

    <a href="{{ brand.url | relative_url }}" class="hero-brand-card__link btn btn--primary">
      {{ buttons_t.view_profile | default: "View Profile" }}
    </a>

    {% include components/helpers/founder-check.html brand=brand class_name="hero-brand-card" %}
  </div>
</article>
