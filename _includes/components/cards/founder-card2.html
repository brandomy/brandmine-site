{% comment %}
  Include Name: components/cards/founder-card.html

  Purpose: Displays a founder card component that shows essential founder information in a
  structured format. Used for the Founders listing page and home page founder focus section.

  Parameters:
  - founder: Founder object with complete details (required)
    Expected properties:
    - name: Founder's name (translatable)
    - ref: Global ID for the founder (e.g., ru-ivan-petrov)
    - portrait_image: Path to founder portrait image
    - brands: Array of brand slugs associated with the founder
    - country_code: Founder's country code
    - expertise: Array of expertise areas
    - generation: Founder's generation (first, second, etc.)
    - featured: Boolean flag for featured status
  - featured: Boolean flag to show enlarged featured version (optional)

  Dependencies:
  - Requires page.lang to be set for proper URL construction
  - CSS: components/cards/founder-card.scss for styling
  - site.data.translations for UI labels
  - site.data.dimensions for taxonomy translations
{% endcomment %}

<article class="founder-card {% if featured or founder.featured %}founder-card--featured{% endif %}"
         data-name="{{ founder.name }}"
         data-market="{{ founder.country_code }}"
         data-expertise="{% for exp in founder.expertise %}{{ exp }}{% unless forloop.last %},{% endunless %}{% endfor %}">
  <header class="founder-card__header">
    <div class="founder-card__portrait">
      {% if founder.portrait_image %}
        {% comment %}
          Fix path formatting for all country codes and ensure proper responsive image paths
          2. Remove any trailing "/founder-portrait.jpg" if present
        {% endcomment %}
        {% assign image_path = founder.portrait_image %}
        {% assign image_path = image_path | replace: "/founder-portrait.jpg", "" %}
        {% assign image_path = image_path | replace: "/portrait.jpg", "" %}
        <img src="{{ site.baseurl }}/{{ image_path }}/founder-portrait-800w.jpg"
             srcset="{{ site.baseurl }}/{{ image_path }}/founder-portrait-400w.jpg 400w,
                     {{ site.baseurl }}/{{ image_path }}/founder-portrait-800w.jpg 800w,
                     {{ site.baseurl }}/{{ image_path }}/founder-portrait-1200w.jpg 1200w"
             alt="{{ founder.name }}"
             class="founder-card__portrait-img"
             onerror="this.onerror=null; this.src='{{ site.baseurl }}/assets/images/founders/founder-headshot-400w.jpg';">
      {% else %}
        <img src="{{ site.baseurl }}/assets/images/founders/placeholder/founder-headshot.jpg"
             alt="{{ founder.name }}"
             class="founder-card__portrait-img">
      {% endif %}
    </div>
    <div class="founder-card__header-text">
      <h2 class="founder-card__title">{{ founder.name }}</h2>

      {% if founder.city and founder.country_code %}
        <p class="founder-card__location">
          {{ founder.city }}, {{ site.data.countries.countries[founder.country_code].name[page.lang] | default: site.data.dimensions[page.lang].markets[founder.country_code] | default: founder.country_code }}
        </p>
      {% elsif founder.country_code %}
        <p class="founder-card__location">
          {{ site.data.countries.countries[founder.country_code].name[page.lang] | default: site.data.dimensions[page.lang].markets[founder.country_code] | default: founder.country_code }}
        </p>
      {% endif %}
    </div>
  </header>

  <div class="founder-card__body">
    {% if founder.brands %}
      <div class="founder-card__brand-connections">
        {% for brand_slug in founder.brands limit:1 %}
          {% assign brand = site.brands | where: "slug", brand_slug | where: "lang", page.lang | first %}
          {% if brand %}
            <p class="founder-card__brand">
              <a href="{{ site.baseurl }}/{{ page.lang }}/brands/{{ brand_slug }}/" class="founder-card__brand-link">
                {{ brand.title }}
              </a>
            </p>
          {% endif %}
        {% endfor %}

        {% if founder.brands.size > 1 %}
          <p class="founder-card__multiple-brands">
            +{{ founder.brands.size | minus: 1 }} {{ site.data.translations[page.lang].founder.more_brands }}
          </p>
        {% endif %}
      </div>
    {% endif %}

    {% if founder.brief_bio %}
      <div class="founder-card__bio">
        {{ founder.brief_bio | truncate: 120 }}
      </div>
    {% endif %}

    <div class="founder-card__expertise-cloud">
      {% if founder.expertise %}
        {% for expertise in founder.expertise limit:3 %}
          <span class="founder-card__tag founder-card__tag--expertise">
            {{ expertise }}
          </span>
        {% endfor %}
      {% endif %}

      {% if founder.dimensions %}
        {% for dimension in founder.dimensions limit:2 %}
          {% assign dimension_type = dimension | split: ":" | first %}
          {% assign dimension_value = dimension | split: ":" | last %}

          <span class="founder-card__tag founder-card__tag--{{ dimension_type }}">
            {{ dimension_value }}
          </span>
        {% endfor %}
      {% elsif founder.sector %}
        <span class="founder-card__tag founder-card__tag--sector">
          {{ founder.sector }}
        </span>
      {% endif %}
    </div>
  </div>

  <footer class="founder-card__footer">
    <a href="{{ site.baseurl }}/{{ page.lang }}/founders/{{ founder.ref }}/" class="founder-card__link">
      {{ site.data.translations[page.lang].buttons.view_profile | default: "View Profile" }}
    </a>

    {% if founder.featured %}
      <div class="founder-card__featured-badge" title="{{ site.data.translations[page.lang].general.featured }}">â˜…</div>
    {% endif %}
  </footer>
</article>
