{% comment %}
================================================================================
COMPONENT: Universal Carousel
PATH: _includes/components/layout/carousel.html
PURPOSE: Multi-content type carousel with grid and mixed display modes for featured content
CREATED: 2024-01-01 | VERSION: 2.5
================================================================================

Features:
- Universal content support for brands, founders, and case studies with type-specific filtering
- Three display modes: carousel, grid, and mixed (hero + carousel) layouts
- Premium content filtering with featured_level hierarchy and fallback logic
- Context-aware CSS custom properties for page-specific styling variations
- Navigation dots with automatic calculation based on content count and layout
- Built-in empty state handling with graceful fallback messaging
- CTA button integration with automatic URL generation for discovery pages
- Responsive design with mobile-first carousel and desktop grid capabilities

Parameters:
- content_type (required): String - Content collection: "brands", "founders", "case-studies"
- page_context (optional): String - Page type for CSS customization: "home-page", "brands-page", "founders-page". Default: "default-page"
- limit (optional): Integer - Maximum items to display. Default: 10
- display_mode (optional): String - Layout mode: "carousel", "grid", "mixed". Default: "carousel"
- premium_only (optional): Boolean - Filter to premium content (featured_level >= 2). Default: false
- title (optional): String - Custom section heading override
- description (optional): String - Custom section description override
- cta_text (optional): String - Custom CTA button text override
- carousel_class (optional): String - Additional CSS classes for carousel container
- lang (required): String - Language code for content filtering and translations

Dependencies:
- CSS: assets/css/components/layout/carousel.scss for carousel and grid layouts
- JavaScript: assets/js/components/layout/carousel.js for interaction and navigation
- Collections: site.brands, site.founders for Jekyll collection data
- Data: site.data.case_studies for case study content
- Helpers: brand-filter.html, brand-card-selector.html, founder-card-selector.html
- Components: Individual card components for content type rendering

Content Type Configurations:
- brands: Featured brand carousel with business focus and market positioning
- founders: Founder stories with leadership and entrepreneurship emphasis
- case-studies: Success story showcases with transformation narratives

Display Mode Details:
- carousel: Horizontal scrolling layout with navigation dots and touch support
- grid: Responsive grid display optimized for desktop viewing and comparison
- mixed: Hero card + carousel combination for featured content emphasis

Usage Examples:
Homepage featured brands:
{% raw %}{% include components/layout/carousel.html
   content_type="brands"
   page_context="home-page"
   limit=8
   display_mode="mixed"
   lang=page.lang %}{% endraw %}

Founders page grid:
{% raw %}{% include components/layout/carousel.html
   content_type="founders"
   page_context="founders-page"
   limit=12
   display_mode="grid"
   title="Leadership Excellence"
   lang=page.lang %}{% endraw %}

Premium brand carousel:
{% raw %}{% include components/layout/carousel.html
   content_type="brands"
   premium_only=true
   limit=6
   cta_text="Explore Premium Brands"
   lang=page.lang %}{% endraw %}

Case studies showcase:
{% raw %}{% include components/layout/carousel.html
   content_type="case-studies"
   page_context="case-studies-page"
   display_mode="carousel"
   description="Real transformations of BRICS+ brands"
   lang=page.lang %}{% endraw %}

Real-world Applications:
- Homepage featured content sections with business intelligence focus
- Category landing pages with filtered brand and founder showcases
- Premium content sections for subscriber-only featured brands
- Success story presentations with case study transformations

BEM Structure:
- .carousel (main carousel container with content type modifiers)
- .carousel--[content_type] (content-specific styling variants)
- .carousel__item (individual content item wrapper)
- .universal-grid (grid layout alternative with responsive columns)
- .universal-grid--[content_type] (grid content type modifiers)
- .carousel-nav (navigation dots container with interaction states)
- .carousel-nav-dot (individual navigation dot with active states)
- .carousel-cta (call-to-action button container and styling)

Accessibility:
- Semantic HTML structure with proper heading hierarchy
- ARIA attributes for carousel navigation and content relationships
- Screen reader friendly navigation dots with descriptive labels
- High contrast navigation elements meeting WCAG AA standards
- Keyboard navigation support for carousel scrolling and grid browsing
- Alternative text and descriptions for all visual content elements

Responsive Design:
- Mobile (320px+): Single column carousel with touch swipe navigation
- Tablet (768px+): Multi-column layouts with enhanced spacing
- Desktop (1024px+): Full grid capabilities with hover state enhancements
- Large screens (1200px+): Optimized layouts with maximum content density

Content Filtering Logic:
- Premium filtering with featured_level >= 2 primary and featured=true fallback
- Language-aware content selection with automatic lang parameter handling
- Collection-specific filtering with optimized Liquid logic for performance
- Empty state handling with graceful degradation and user messaging

Navigation Features:
- Automatic dot count calculation based on content size and display logic
- Active state management with JavaScript-driven interaction handling
- Touch-friendly navigation targets optimized for mobile interaction
- Keyboard navigation support with arrow key and enter key handling

Performance Optimization:
- Efficient Liquid filtering with minimal collection iterations
- Lazy loading preparation for JavaScript-enhanced carousels
- CSS custom properties for dynamic theming without JavaScript overhead
- Optimized DOM structure with semantic HTML for fast rendering

Business Intelligence Integration:
- BRICS+ market positioning in default content descriptions
- Investment and partnership focus in brand carousel messaging
- Leadership and entrepreneurship emphasis in founder presentations
- Success story narratives in case study showcases

Translation Integration:
- Comprehensive multilingual support via helpers/t.html integration
- Fallback text ensuring functionality across all language configurations
- Content-specific translation keys for specialized messaging
- Cultural adaptation of CTA text and value propositions

Error Handling:
- Parameter validation with graceful component degradation
- Missing content type handling with clear developer messaging
- Empty collection fallbacks with user-friendly empty state displays
- Missing helper file handling with fallback filtering logic
================================================================================
{% endcomment %}

{% comment %} Parameter validation {% endcomment %}
{% unless include.content_type %}
  <!-- Universal Carousel: Missing required content_type parameter -->
  {% break %}
{% endunless %}

{% comment %} Parameter setup {% endcomment %}
{% assign current_lang = page.lang | default: 'en' %}
{% assign content_type = include.content_type %}
{% assign page_context = include.page_context | default: "default-page" %}
{% assign limit = include.limit | default: 10 %}
{% assign display_mode = include.display_mode | default: "carousel" %}
{% assign premium_only = include.premium_only | default: false %}
{% assign carousel_class = include.carousel_class | default: "" %}

{% comment %} Content-type specific setup {% endcomment %}
{% case content_type %}
  {% when "brands" %}
    {% assign collection_name = "brands" %}
    {% assign card_selector = "helpers/brand-card-selector.html" %}
    {% assign filter_helper = "helpers/brand-filter.html" %}
    {% assign translation_key_prefix = "brands" %}
    {% assign default_title = "Featured Brands" %}
    {% assign default_description = "Market-proven winners with compelling founder stories and explosive growth potential" %}
    {% assign default_cta = "Explore All Brands" %}
    {% assign target_url = site.baseurl | append: "/" | append: current_lang | append: "/brands/" %}
  {% when "founders" %}
    {% assign collection_name = "founders" %}
    {% assign card_selector = "helpers/founder-card-selector.html" %}
    {% assign filter_helper = "helpers/founder-filter.html" %}
    {% assign translation_key_prefix = "founders" %}
    {% assign default_title = "Featured Founders" %}
    {% assign default_description = "Meet the visionary entrepreneurs behind BRICS+ brands with global potential" %}
    {% assign default_cta = "Explore All Founders" %}
    {% assign target_url = site.baseurl | append: "/" | append: current_lang | append: "/founders/" %}
  {% when "case-studies" %}
    {% assign collection_name = "case-studies" %}
    {% assign card_selector = "helpers/case-study-card-selector.html" %}
    {% assign filter_helper = "helpers/case-study-filter.html" %}
    {% assign translation_key_prefix = "case_studies" %}
    {% assign default_title = "Success Stories" %}
    {% assign default_description = "Real transformations of founder-led brands breaking through global markets" %}
    {% assign default_cta = "View All Case Studies" %}
    {% assign target_url = site.baseurl | append: "/" | append: current_lang | append: "/case-studies/" %}
  {% else %}
    <!-- Unknown content_type: {{ content_type }} -->
    {% break %}
{% endcase %}

{% comment %} Section heading {% endcomment %}
<h2 class="panel__heading-secondary">
  {% if include.title %}
    {{ include.title }}
  {% else %}
    {% assign title_key = translation_key_prefix | append: ".featured.title" %}
    {% include helpers/t.html key=title_key fallback=default_title %}
  {% endif %}
</h2>
<p class="panel__lead-text">
  {% if include.description %}
    {{ include.description }}
  {% else %}
    {{ default_description }}
  {% endif %}
</p>

{% comment %} Content filtering {% endcomment %}
{% if content_type == "brands" %}
  {% include helpers/brand-filter.html lang=current_lang featured=true premium_only=premium_only limit=limit %}
  {% assign filtered_content = filtered_brands %}
{% elsif content_type == "founders" %}
  {% comment %} Founder filtering - fallback to direct collection filter if helper doesn't exist {% endcomment %}
  {% assign all_founders = site.founders | where: "lang", current_lang %}
  {% if premium_only %}
    {% assign filtered_content = all_founders | where: "featured_level", 2 %}
    {% if filtered_content.size == 0 %}
      {% assign filtered_content = all_founders | where: "featured", true %}
    {% endif %}
  {% else %}
    {% assign filtered_content = all_founders | where: "featured", true %}
  {% endif %}
  {% assign filtered_content = filtered_content | limit: limit %}
{% elsif content_type == "case-studies" %}
  {% comment %} Case studies filtering from data file {% endcomment %}
  {% assign all_case_studies = site.data.case_studies[current_lang] %}
  {% assign filtered_content = all_case_studies | where: "featured", true | limit: limit %}
{% endif %}

{% comment %} Display modes {% endcomment %}
{% if display_mode == "mixed" and filtered_content.size > 0 %}
  <!-- Mixed mode: First item as hero, rest in carousel -->
  {% assign first_item = filtered_content | first %}
  {% if content_type == "brands" %}
    {% include helpers/brand-card-selector.html brand=first_item force_variant="hero" %}
  {% elsif content_type == "founders" %}
    {% include helpers/founder-card-selector.html founder=first_item force_variant="hero" %}
  {% elsif content_type == "case-studies" %}
    {% include helpers/case-study-card-selector.html case_study=first_item force_variant="hero" %}
  {% endif %}

  <div class="carousel carousel--{{ content_type }} {{ carousel_class }}" 
       data-component-type="featured-{{ content_type }}" 
       data-page-context="{{ page_context }}">
    {% for item in filtered_content offset:1 limit:limit %}
      <div class="carousel__item">
        {% if content_type == "brands" %}
          {% include helpers/brand-card-selector.html brand=item %}
        {% elsif content_type == "founders" %}
          {% include helpers/founder-card-selector.html founder=item %}
        {% elsif content_type == "case-studies" %}
          {% include helpers/case-study-card-selector.html case_study=item %}
        {% endif %}
      </div>
    {% endfor %}
  </div>
  
{% elsif display_mode == "grid" %}
  <!-- Grid display mode -->
  <div class="universal-grid universal-grid--{{ content_type }}" 
       data-component-type="featured-{{ content_type }}-grid" 
       data-page-context="{{ page_context }}">
    {% for item in filtered_content %}
      <div class="carousel__item">
        {% if content_type == "brands" %}
          {% include helpers/brand-card-selector.html brand=item %}
        {% elsif content_type == "founders" %}
          {% include helpers/founder-card-selector.html founder=item %}
        {% elsif content_type == "case-studies" %}
          {% include helpers/case-study-card-selector.html case_study=item %}
        {% endif %}
      </div>
    {% endfor %}
  </div>
  
{% else %}
  <!-- Default carousel mode -->
  <div class="carousel carousel--{{ content_type }} {{ carousel_class }}" 
       data-component-type="featured-{{ content_type }}" 
       data-page-context="{{ page_context }}">
    {% if filtered_content.size > 0 %}
      {% for item in filtered_content %}
        <div class="carousel__item">
          {% if content_type == "brands" %}
            {% include helpers/brand-card-selector.html brand=item %}
          {% elsif content_type == "founders" %}
            {% include helpers/founder-card-selector.html founder=item %}
          {% elsif content_type == "case-studies" %}
            {% include helpers/case-study-card-selector.html case_study=item %}
          {% endif %}
        </div>
      {% endfor %}
    {% else %}
      <!-- Fallback content if no items available -->
      <p class="no-content-message">
        {% assign empty_key = "common.empty_states.no_" | append: content_type %}
        {% assign empty_fallback = "No featured " | append: content_type | append: " available yet." %}
        {% include helpers/t.html key=empty_key fallback=empty_fallback %}
      </p>
    {% endif %}
  </div>
{% endif %}

{% comment %} Navigation dots for carousel modes {% endcomment %}
{% if display_mode != "grid" %}
  <div class="carousel-nav" data-target="featured-{{ content_type }}" data-page-context="{{ page_context }}">
    {% assign dot_count = filtered_content.size | divided_by: 2 | ceil | at_least: 1 %}
    {% for i in (1..dot_count) %}
      <span class="carousel-nav-dot {% if forloop.first %}active{% endif %}" data-slide="{{ forloop.index0 }}"></span>
    {% endfor %}
  </div>
{% endif %}

{% comment %} CTA Button {% endcomment %}
<div class="carousel-cta">
  <a href="{{ target_url }}"
     class="btn btn--primary-cta"
     data-track="featured-{{ content_type }}">
    {% if include.cta_text %}
      {{ include.cta_text }}
    {% else %}
      {{ default_cta }}
    {% endif %}
  </a>
</div>